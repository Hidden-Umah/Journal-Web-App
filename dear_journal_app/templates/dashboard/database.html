{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Database - Dear Journal</title>
    <link rel="stylesheet" href="{% static 'dashboard/css/dashboard.css' %}" />
  </head>
  <body>
    <section class="dashboard">
      <div class="generalInfo">
        <!-- Header -->
        <div class="heading">
          <h2>Database Overview</h2>
          <div
            class="dashboard-actions"
            style="
              margin-top: 18px;
              display: flex;
              gap: 18px;
              justify-content: center;
            "
          >
            <a href="{% url 'dashboard' %}" class="dashboard-btn">Overview</a>
            <a
              href="{% url 'database' %}"
              class="dashboard-btn dashboard-btn-alt"
              >Database</a
            >
          </div>
        </div>

        <!-- Admins -->
        <h2>Admins (Superusers)</h2>
        <p>Total Admins: {{ total_admins }}</p>
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Username</th>
              <th>Email</th>
              <th>Date Joined</th>
            </tr>
          </thead>
          <tbody>
            {% for admin in admins %}
            <tr>
              <td>{{ admin.id }}</td>
              <td>{{ admin.username }}</td>
              <td>{{ admin.email }}</td>
              <td>{{ admin.date_joined|date:"Y-m-d" }}</td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="4" class="empty-row">No admins found.</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>

        <!-- Clients -->
        <h2>Clients</h2>
        <p>Total Clients: {{ total_clients }}</p>
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Username</th>
              <th>Email</th>
              <th>Profile Picture</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            {% for client in clients %}
            <tr>
              <td>{{ client.id }}</td>
              <td>{{ client.username }}</td>
              <td>{{ client.email }}</td>
              <td>
                {% if client.profile_picture %}
                <img
                  src="{{ client.profile_picture.url }}"
                  alt="Profile"
                  width="40"
                  height="40"
                  style="border-radius: 50%"
                />
                {% else %} â€” {% endif %}
              </td>
              <td>
                <a
                  href="{% url 'delete_client' client.id %}"
                  onclick="return confirm('Are you sure you want to delete {{ client.username }}?')"
                  class="dashboard-btn dashboard-btn-alt"
                  style="
                    background: red;
                    color: white;
                    padding: 5px 10px;
                    border-radius: 5px;
                    text-decoration: none;
                  "
                >
                  Delete
                </a>
              </td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="5" class="empty-row">No clients found.</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>

        <!-- Journals -->
        <h2>Journals</h2>
        <p>Total Journals: {{ total_journals }}</p>
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>User</th>
              <th>Title</th>
              <th>Date Created</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            {% for journal in journals %}
            <tr>
              <td>{{ journal.id }}</td>
              <td>{{ journal.user.username }}</td>
              <td>{{ journal.title }}</td>
              <td>{{ journal.created_at|date:"Y-m-d" }}</td>
              <td>{{ journal.status }}</td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="5" class="empty-row">No journals found.</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </section>
  </body>
</html>
